<html>
		<head>
				<title>DB</title>
				<meta http-equiv="Content-type" content="text/html; charset=UTF8">
				<!-- $Id$ -->

                <!-- Include required JS files -->
                <script type="text/javascript" src="ui/src/shCore.js"></script>
                <!-- At least one brush, here we choose JS. You need to include a brush for every language you want to highlight -->
                <script type="text/javascript" src="ui/scripts/shBrushJScript.js"></script>
                <script type="text/javascript" src="ui/scripts/shBrushPerl.js"></script>
                <script type="text/javascript" src="ui/scripts/shBrushBash.js"></script>
                <script type="text/javascript">
                     SyntaxHighlighter.all()
                </script>


                <!-- Include *at least* the core style and default theme -->
                <link href="ui/styles/shCore.css" rel="stylesheet" type="text/css" />
                <link href="ui/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
		</head>
		<body>
				<h1>w3m local CGI 設定手順</h1>

				<a href="#content">content</a>

                <img width="100%" src="images/internet-w3m006.png"  alt="" />

				<hr>
				<a name="000"><h1>local CGI を保存するディレクトリを作成</h1></a>
                <p>local CGI を保存するディレクトリは任意の場所でOK。</p>
                <p>~/.w3m/cgi-binが一般的。</p>
                <pre >
$ mkdir ~/.w3m/cgi-bin
                </pre>

				<hr>
				<a name="001"><h1>local CGI を保存するディレクトリをw3mに設定</h1></a>
                <p>
                cgi-binディレクトリをw3mに認識させる。
                </p>
                <p>w3mを起動し「o」コマンドで設定が面を開き、「/cgi-bin で表されるディレクトリ」を設定する。</p>
                <img src="./images/w3m-capture001.jpg" alt="w3m cgi-bin の設定"/>


				<hr>
				<a name="002"><h1>CGI を作成</h1></a>
                cgi-binディレクトリ以下にCGIを作成する。
                <pre >
$ vi ~/.w3m/cgi-bin/test.cgi
                </pre>
                <pre class="brush: perl">
#!/usr/bin/perl

use strict;
use warnings;

my $type = $ENV{W3M_TYPE};
my $charset = $ENV{W3M_CHARSET};

print &lt;&lt;EOF;
Content-Type: $type; charset=$charset

EOF

print "Hello, World!";
                </pre>

                CGIに実行権限を付ける。
                <pre >
$ chmod 755 ~/.w3m/cgi-bin/test.cgi
                </pre>

				<hr>
				<a name="003"><h1>CGI を呼び出す keymap を設定</h1></a>
                <pre >
$ vi ~/.w3m/keymap
                </pre>
                <pre class="brush: shell">
                keymap  M-t GOTO file:/cgi-bin/test.cgi
                </pre>

                <p>
                上記設定の場合、w3mを起動して「Esc-t」でtest.cgiが起動する。
                </p>

				<hr>
				<a name="004"><h1>local CGI サンプル</h1></a>
                <ul>
                    <li><a href="./cgi-bin/base.txt">表示していたHTMLを再表示するだけの CGI(これをコピーして独自CGIを書いていくと便利)</a></li>
                    <li><a href="./cgi-bin/env.txt">w3mが提供する環境変数を表示する CGI </a></li>
                </ul>

				<hr>
				<a name="005"><h1>w3mが提供する環境変数</h1></a>
                <table border="1">
                <tr><th>環境変数の名前</th><th>説明</th><th>値例</th></tr>
                <tr><td> W3M_TTY </td><td>w3mが表示されている画面のtty</td><td>/dev/pts/4</td></tr>
                <tr><td> W3M_CHARSET </td><td>local CGI を呼び出した元の文字コード</td><td>Shift_JIS</td></tr>
                <tr><td> W3M_TYPE </td><td>local CGI を呼び出した元の content type</td><td>text/html</td></tr>
                <tr><td> W3M_CURRENT_FORM </td><td>カーソルがあった場所のフォーム要素</td><td>input type=text name="q" (GET /search)</td></tr>
                <tr><td> W3M_TITLE </td><td>local CGI を呼び出した元の HTML title</td><td>Google</td></tr>
                <tr><td> W3M_URL </td><td>local CGI を呼び出した元の URL</td><td>http://www.google.co.jp/</td></tr>
                <tr><td> W3M_SOURCEFILE </td><td>local CGI を呼び出した元のコンテンツファイル(HTMLなど)</td><td>/home/dot/.w3m/w3msrc4760-0.html</td></tr>
                <tr><td> W3M_FILENAME </td><td>local CGI を呼び出した元のファイル名</td><td>/</td></tr>
                <tr><td> W3M_CURRENT_COLUMN </td><td>カーソルがあった場所の列番号</td><td>1</td></tr>
                <tr><td> W3M_CURRENT_LINE </td><td>カーソルがあった場所の行番号</td><td>3</td></tr>
                <tr><td> W3M_CURRENT_LINK </td><td>カーソルがリンクに乗っかっていた場合、リンク先のURL</td><td>http://www.google.co.jp</td></tr>
                <tr><td> W3M_CURRENT_IMG </td><td>カーソルが画像に乗っかっていた場合、画像のURL</td><td> http://www.google.co.jp/logos/holiday09_3.gif</td></tr>
                <tr><td> W3M_CURRENT_WORD </td><td>カーソルが乗っかっていた文字列</td><td>iGoogle</td></tr>
                </table>

				<hr>
				<a name="content">content</a>
				<ul>
					<li><a href="#000">local CGI を保存するディレクトリを作成</a>
					<li><a href="#001">local CGI を保存するディレクトリをw3mに設定</a>
					<li><a href="#002">CGI を作成</a>
					<li><a href="#003">CGI を呼び出す keymap を設定</a>
					<li><a href="#004">local CGI サンプル</a>
					<li><a href="#005">w3mが提供する環境変数</a>
				</ul>
		</body>
</html>
