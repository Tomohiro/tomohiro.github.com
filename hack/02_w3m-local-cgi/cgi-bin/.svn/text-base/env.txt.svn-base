#!/usr/bin/perl

# $Id$

use strict;
use warnings;

my $zcat = '/bin/zcat';
my $type = $ENV{W3M_TYPE};
my $charset = $ENV{W3M_CHARSET};
my $url = $ENV{W3M_URL};
my $file = $ENV{W3M_SOURCEFILE};
exit if !-f $file;
$| = 1;

print <<EOF;
Content-Type: $type; charset=$charset

EOF

if ($type =~ /^text\/html/i && $url){
    print "<base href=\"$url\">\n";
}

if ($file =~ /\.gz$/i ){
    open(IN, "$zcat $file |");
} else {
    open(IN, "< $file");
}

foreach my $key (keys %ENV){
    if($key =~ /w3m/i){
        print $key . " : " . $ENV{$key} . "<br />";
    }
}
while (<IN>){
    print $_;
}
close(IN);
